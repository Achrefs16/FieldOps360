apiVersion: traefik.containo.us/v1alpha1
kind: IngressRoute
metadata:
  name: fieldops-api-gateway
  namespace: fieldops-dev
spec:
  entryPoints:
    - web
  routes:
    # ----------------------------------------------------------------------
    # Auth Service
    # ----------------------------------------------------------------------
    - match: PathPrefix(`/api/auth`)
      kind: Rule
      services:
        - name: auth-service
          port: 3001

    # ----------------------------------------------------------------------
    # Project Service
    # ----------------------------------------------------------------------
    - match: PathPrefix(`/api/projects`) || PathPrefix(`/api/tasks`) || PathPrefix(`/api/phases`)
      kind: Rule
      services:
        - name: project-service
          port: 3002

    # ----------------------------------------------------------------------
    # Resource Service
    # ----------------------------------------------------------------------
    - match: PathPrefix(`/api/resources`) || PathPrefix(`/api/vehicles`) || PathPrefix(`/api/equipment`)
      kind: Rule
      services:
        - name: resource-service
          port: 3003

    # ----------------------------------------------------------------------
    # Planning Service
    # ----------------------------------------------------------------------
    - match: PathPrefix(`/api/planning`)
      kind: Rule
      services:
        - name: planning-service
          port: 3004

    # ----------------------------------------------------------------------
    # Reporting Service
    # ----------------------------------------------------------------------
    - match: PathPrefix(`/api/reports`)
      kind: Rule
      services:
        - name: reporting-service
          port: 3005
